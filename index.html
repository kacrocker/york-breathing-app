<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMST 150 Trainer</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Configuration -->
    <script>
        /**
         * Tailwind Configuration Overrides
         * 
         * Use this object to add project-specific colors and fonts.
         * Novice tip: change these hex codes to update theme colors across the app.
         */
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#10b981',    // Emerald 500 (used for main action buttons and highlights)
                        'secondary': '#059669',  // Emerald 600 (hover state)
                        'dark-bg': '#1f2937',    // Gray 800 (app background)
                        'light-text': '#f9fafb', // Gray 50 (text color)
                    },
                    fontFamily: {
                        // Primary app font stack â€” change to any web-safe or imported font
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- Custom Styles (animations and confetti) -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-dark-bg font-sans text-light-text flex items-center justify-center p-4 min-h-screen">
    
    <!-- Confetti Container (Fixed and hidden by default)
         Visual element: This container holds animated 'confetti' particles generated by JavaScript.
         Keep the id confetti-container if you change placement or styling because JS looks it up.
         Tip: Adjust CONFETTI_COLORS or particle count in showCelebration() (app.js) to change the effect. -->
    <div id="confetti-container" class="fixed inset-0 pointer-events-none z-50 overflow-hidden"></div>

    <!-- App Root Container
         Contains two main "screens":
         - #setup-screen: visible at load; where you pick durations and start the session
         - #workout-screen: hidden at load; shows the timer, controls, and set progress
         You can toggle visibility by adding/removing the 'hidden' class on these elements. -->
    <div id="app" class="w-full max-w-lg bg-gray-700 p-6 sm:p-8 rounded-xl shadow-2xl transition-all duration-300">
        
        <!-- Permanent Header -->
        <h1 class="text-3xl font-bold text-center text-primary mb-2">
            <span class="sm:hidden">York Timer</span>
            <span class="hidden sm:inline">York Breathing Exercise Timer</span>
        </h1>
        <p class="text-center text-sm text-gray-400 mb-6 hidden sm:block">for use with an EMST 75/150 Trainer</p>

        <!-- ============================================================
             SETUP SCREEN (VISIBLE ON LOAD)
             ============================================================ -->
        <div id="setup-screen" class="flex flex-col items-center justify-center space-y-6">
            
            <!-- Duration Selector
                 Allows user to select between 15-second and 30-second rest phases -->
            <div id="rest-duration-selector" class="w-full p-4 bg-gray-800 rounded-lg text-sm text-gray-300 border-l-4 border-gray-600">
                <label class="block text-md font-semibold text-gray-100 mb-2">Select Rest Phase Duration:</label>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-6">
                    <!-- 15 Second Option (Default Selected) -->
                    <div class="flex-1 bg-primary text-white rounded-lg p-3 cursor-pointer text-center font-bold transition-colors duration-200 shadow-md border-2 border-primary"
                         id="btn-duration-15" onclick="handleRestDurationChange('15')">
                        15 seconds
                    </div>
                    <!-- 30 Second Option -->
                    <div class="flex-1 bg-gray-600 text-gray-300 rounded-lg p-3 cursor-pointer text-center font-bold transition-colors duration-200 shadow-md border-2 border-transparent hover:border-gray-500"
                         id="btn-duration-30" onclick="handleRestDurationChange('30')">
                        30 seconds
                    </div>
                </div>
            </div>
            
            <!-- Initial Instruction Message -->
            <div class="text-center w-full">
                 <div id="initial-instruction-text" class="text-base font-semibold text-gray-300 sm:mb-2 px-4">
                    Please make sure your sound is ON and the volume is turned up. Then press "Start Session" to begin. Focus on inhaling deeply and exhaling forcefully and quickly against the device's resistance.
                 </div>
            </div>
            
            <!-- Start Session Button -->
            <button id="start-button" 
                    class="px-6 py-3 text-lg font-semibold rounded-lg bg-primary hover:bg-secondary text-light-text transition-all duration-200 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-primary focus:ring-opacity-50 w-full max-w-xs sm:max-w-none">
                Start Session
            </button>
        </div>

        <!-- ============================================================
             WORKOUT SCREEN (HIDDEN ON LOAD)
             ============================================================ -->
        <div id="workout-screen" class="hidden">
            
            <!-- Status Display
                 Shows current phase instructions (Inhale, Exhale, Rest, etc.) -->
            <div class="text-center mb-4">
                <div id="status-text" class="text-3xl font-extrabold mb-2 h-10 text-white flex items-center justify-center transition-colors duration-300">Ready</div>
            </div>

            <!-- Timer & Controls Wrapper
                 Responsive layout:
                 - Mobile: Timer on top, controls below in a row
                 - Desktop: Timer on left, controls stacked on right -->
            <div class="flex flex-col sm:flex-row sm:justify-around sm:items-center mb-10">

                <!-- Timer Display (The big circle) -->
                <div id="timer-display-container" class="relative flex items-center justify-center h-40 w-40 sm:h-56 sm:w-56 mx-auto sm:mx-0">
                    <!-- Pulse Ring (only visible when active) -->
                    <div id="pulse-ring" class="absolute h-full w-full rounded-full bg-primary opacity-30 hidden"></div>
                    
                    <!-- Main Timer Circle -->
                    <div class="relative flex flex-col items-center justify-center h-full w-full rounded-full bg-gray-800 border-4 border-gray-600 shadow-inner-xl transition-all duration-300">
                        <span id="timer-value" class="text-5xl sm:text-7xl font-mono font-bold text-primary transition-colors duration-300">0</span>
                        <span class="text-sm font-medium text-gray-400 mt-2">seconds</span>
                    </div>
                </div>

                <!-- Controls Wrapper
                     Responsive behavior:
                     - Mobile (default): controls appear in a single row beneath the timer
                     - Desktop (sm and up): controls stack vertically to the right of the timer
                     - When the round timer is hidden (success), JS will add mx-auto so the controls are centered -->
                <div id="controls-wrapper" class="mt-4 sm:mt-0 flex flex-row items-center justify-center gap-3 w-full sm:flex-col sm:justify-center sm:space-y-4 sm:w-1/3 sm:min-w-max">
                    
                    <!-- Active/Paused Controls -->
                    <div id="active-controls" class="flex flex-row items-center gap-3 sm:flex-col sm:space-y-4">
                        <!-- Pause/Resume Button -->
                        <button id="pause-resume-button" 
                                class="px-6 py-3 text-lg font-semibold rounded-lg bg-red-600 hover:bg-red-700 text-light-text transition-all duration-200 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-red-600 focus:ring-opacity-50 w-auto sm:w-full">
                            Pause
                        </button>
                        <!-- Reset Button -->
                        <button id="reset-button" 
                                class="px-6 py-3 text-lg font-semibold rounded-lg bg-gray-500 hover:bg-gray-600 text-light-text transition-all duration-200 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-gray-500 focus:ring-opacity-50 w-auto sm:w-full">
                            Reset
                        </button>
                    </div>

                    <!-- New Session Button
                         Hidden by default, shown only when the session completes successfully -->
                    <div class="mt-0 sm:mt-4 flex justify-center">
                        <button id="new-session-button" class="hidden px-6 py-3 text-lg font-semibold rounded-lg bg-primary hover:bg-secondary text-light-text transition-all duration-200 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-primary focus:ring-opacity-50 w-auto sm:w-full max-w-xs">
                            New Session
                        </button>
                    </div>
                </div>
            </div>

            <!-- Set Progress Status Boxes
                 Shows 5 boxes representing each set (5 reps per set) -->
            <div class="mt-4 sm:mt-2 pt-4 border-t border-gray-600">
                <h3 class="text-lg font-semibold text-gray-300 mb-4 text-center">
                    <span class="sm:hidden">Set Progress</span>
                    <span class="hidden sm:inline">Set Progress (Breathes Completed)</span>
                </h3>
                <div id="set-progress-container" class="grid grid-cols-5 gap-3">
                    
                    <!-- Set Box 1 -->
                    <div id="set-box-1" class="set-box p-1 rounded-lg text-center bg-gray-500 transition-colors duration-300 shadow-xl">
                        <div class="text-xs font-medium text-light-text opacity-70">Set 1</div>
                        <!-- Count row: wraps the numeric counter and the checkmark so the checkmark appears
                             directly to the right of the number when a set is completed. -->
                        <div class="count-row mt-1 flex items-center justify-center">
                            <div class="set-rep-counter text-lg font-bold text-light-text">0</div>
                            <div class="checkmark-container hidden ml-2 inline-flex items-center" aria-hidden="true">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Set Box 2 -->
                    <div id="set-box-2" class="set-box p-1 rounded-lg text-center bg-gray-500 transition-colors duration-300 shadow-xl">
                        <div class="text-xs font-medium text-light-text opacity-70">Set 2</div>
                        <div class="count-row mt-1 flex items-center justify-center">
                            <div class="set-rep-counter text-lg font-bold text-light-text">0</div>
                            <div class="checkmark-container hidden ml-2 inline-flex items-center" aria-hidden="true">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Set Box 3 -->
                    <div id="set-box-3" class="set-box p-1 rounded-lg text-center bg-gray-500 transition-colors duration-300 shadow-xl">
                        <div class="text-xs font-medium text-light-text opacity-70">Set 3</div>
                        <div class="count-row mt-1 flex items-center justify-center">
                            <div class="set-rep-counter text-lg font-bold text-light-text">0</div>
                            <div class="checkmark-container hidden ml-2 inline-flex items-center" aria-hidden="true">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Set Box 4 -->
                    <div id="set-box-4" class="set-box p-1 rounded-lg text-center bg-gray-500 transition-colors duration-300 shadow-xl">
                        <div class="text-xs font-medium text-light-text opacity-70">Set 4</div>
                        <div class="count-row mt-1 flex items-center justify-center">
                            <div class="set-rep-counter text-lg font-bold text-light-text">0</div>
                            <div class="checkmark-container hidden ml-2 inline-flex items-center" aria-hidden="true">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Set Box 5 -->
                    <div id="set-box-5" class="set-box p-1 rounded-lg text-center bg-gray-500 transition-colors duration-300 shadow-xl">
                        <div class="text-xs font-medium text-light-text opacity-70">Set 5</div>
                        <div class="count-row mt-1 flex items-center justify-center">
                            <div class="set-rep-counter text-lg font-bold text-light-text">0</div>
                            <div class="checkmark-container hidden ml-2 inline-flex items-center" aria-hidden="true">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Total Time Remaining Display (HIDDEN)
                 Uncomment the 'hidden' class removal in app.js to show this -->
            <div class="mt-4 pb-2 text-center text-sm font-medium text-gray-400 hidden">
                <span id="total-time-label">Time Remaining:</span>
                <span id="total-time-value" class="ml-2 text-white font-bold">00:00</span>
            </div>
            
        </div>
    </div>

    <!-- ============================================================
         RESET CONFIRMATION MODAL
         ============================================================ -->
    <div id="reset-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-75 transition-opacity duration-300" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="bg-gray-700 rounded-xl p-6 w-11/12 max-w-sm shadow-2xl transform transition-all">
            <div class="flex flex-col items-center">
                <!-- Warning Icon -->
                <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                    <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.332 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <!-- Modal Content -->
                <div class="mt-3 text-center">
                    <h3 class="text-lg leading-6 font-medium text-light-text" id="modal-title">Reset Session?</h3>
                    <div class="mt-2">
                        <p class="text-sm text-gray-300">
                            Are you sure you want to **Reset** this exercise session? All progress will be lost.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Modal Actions -->
            <div class="mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3">
                <button type="button" id="confirm-reset" 
                        class="inline-flex w-full justify-center rounded-lg border border-transparent bg-red-600 px-4 py-2 text-base font-medium text-light-text shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 sm:col-start-2 sm:text-sm transition-colors duration-200">
                    Yes, Reset
                </button>
                <button type="button" id="cancel-reset"
                        class="mt-3 inline-flex w-full justify-center rounded-lg border border-gray-600 bg-gray-600 px-4 py-2 text-base font-medium text-light-text shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:col-start-1 sm:mt-0 sm:text-sm transition-colors duration-200">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Main Application JavaScript -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
